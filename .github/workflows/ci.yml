name: ‚≠ê CI

on:
    push:
        branches:
            - trunk
    pull_request_target:
        branches:
            - trunk
    workflow_dispatch:

jobs:
    ci:
        uses: ./.github/workflows/call-make.yml

    cd:
        runs-on: ubuntu-latest
        needs: ci

        steps:
            - name: üõí Checkout
              uses: actions/checkout@v3
              with:
                  ref: ${{ github.event.pull_request.head.sha }}
                  fetch-depth: '0'

            - name: üè∑Ô∏è Bump version and push tag
              uses: anothrNick/github-tag-action@v1
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                  WITH_V: true
                  VERBOSE: false
