name: ‚≠ê CI

on:
    push:
        branches:
            - trunk
    pull_request_target:
        branches:
            - trunk
    workflow_dispatch:

jobs:
    ci:
        uses: ./.github/workflows/call-make.yml

    cd:
        runs-on: ubuntu-latest
        needs: ci

        steps:
            - name: üõí Checkout
              uses: actions/checkout@v3
              with:
                  ref: ${{ github.event.pull_request.head.sha }}
                  fetch-depth: '0'

            - name: üè∑ Release Please
              uses: google-github-actions/release-please-action@v3.1.2
              with:
                  release-type: simple
                  package-name: Z0ne.Collections
                  extra-files: |
                      {
                        "type": "xml",
                        "path": "Directory.Build.props",
                        "xpath": "//AssemblyVersion"
                      }
